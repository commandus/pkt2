syntax = "proto3";

package pkt2;

enum InputType {
    TYPE_NONE               = 0;
    TYPE_DOUBLE             = 1;
    TYPE_INT                = 2;
    TYPE_UINT               = 3;
    TYPE_CHAR               = 4;
    TYPE_STRING             = 5;
};

enum Type {
    // 0 is reserved for errors.
    TYPE_DOUBLE             = 1;
    TYPE_FLOAT              = 2;
    TYPE_INT64              = 3;
    TYPE_UINT64             = 4;
    TYPE_INT32              = 5;
    TYPE_FIXED64            = 6;
    TYPE_FIXED32            = 7;
    TYPE_BOOL               = 8;
    TYPE_STRING             = 9;
    TYPE_GROUP              = 10;  // Tag-delimited aggregate.
    TYPE_MESSAGE            = 11;  // Length-delimited aggregate.
    TYPE_BYTES              = 12;
    TYPE_UINT32             = 13;
    TYPE_ENUM               = 14;
    TYPE_SFIXED32           = 15;
    TYPE_SFIXED64           = 16;
    TYPE_SINT32             = 17;  // Uses ZigZag encoding.
    TYPE_SINT64             = 18;  // Uses ZigZag encoding.
};

enum Endian {
    STREAM                  = 0;   // no order at all  
    LITTLE_ENDIAN           = 1;
    BIG_ENDIAN              = 2;
};

message Field {
    string name             = 1;
    InputType type          = 2;
    Endian endian           = 3;
    uint32 offset           = 4;
    uint32 size             = 5;
}

message Variable {
    string name             = 1;
    Type type               = 2;
    string short_name       = 3;  ///<   отображаемое имя
    string full_name        = 4;  ///<   описание
    string measure_unit     = 5;  ///<   название единицы измерения (если не задан values)
    map<string,string> formula
                            = 6;  ///<   формула на заданном языке для приведения значения к единице измерения (если не задан values). Применяются name в вычислениях.
    repeated string values  = 7;  ///<   строки для флагов или перечислений по порядку. Если задан, measure_unit и formula не действуют.
    uint32 priority         = 8;  ///<   уровень детализации отображения. 0 (высший)- отображать всегда (по умолчанию), 1- не отображать (не записывать в БД)
    string format           = 9;  ///<   формат преобразования в строку (для определенных типов, например, 8.2f для указания точности)
}

enum Proto {
    PROTO_NONE              = 0;   // unknown
    PROTO_TCP               = 1;
    PROTO_UDP               = 2;
};

message Address {
    Proto proto             = 1;
    string address          = 2;
    uint32 port             = 3;
}

message Packet {
    Address source          = 1;
    Address destination     = 2;
    string name             = 3;  ///<   лат. имя. Моет использоваться для расщирния файлов, имен таблиц БД и т.д.
    string short_name       = 4;  ///<   отображаемое имя
    string full_name        = 5;  ///<   описание
    repeated message Variable 
                  variables = 6;  ///<   выходные значения для записи в БД
}
